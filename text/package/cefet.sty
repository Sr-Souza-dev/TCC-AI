\NeedsTeXFormat{LaTeX2e}


\RequirePackage{ifthen}

\newlength{\tempMargemSuperior}
\newlength{\tempMargemInferior}
\newlength{\tempMargemEsquerda}
\newlength{\tempMargemDireita}

\newlength{\MargemSuperior}
\newlength{\MargemInferior}
\newlength{\MargemEsquerda}
\newlength{\MargemDireita}

\newcommand{\SalvaMargens}{
    \setlength{\tempMargemSuperior}{1in + \voffset + \topmargin + \headheight + \headsep}
    \setlength{\tempMargemInferior}{\paperheight-\textheight-\tempMargemSuperior}
    \setlength{\tempMargemEsquerda}{1in + \hoffset + \oddsidemargin}
    \setlength{\tempMargemDireita}{\paperwidth-\textwidth-\tempMargemEsquerda}
}

\newcommand{\AlteraMargens}[5][2cm]{
    \setlength{\MargemSuperior}{#2}
    \setlength{\MargemInferior}{#3}
    \setlength{\MargemEsquerda}{#4}
    \setlength{\MargemDireita}{#5}

    \setlength{\voffset}{#1-1in}
    \setlength{\hoffset}{-1in}
    \setlength{\oddsidemargin}{\MargemEsquerda-\MargemDireita}
    \setlength{\hoffset}{\MargemEsquerda-1in-\oddsidemargin}
    \setlength{\textwidth}{\paperwidth-\MargemEsquerda-\MargemDireita}
    \setlength{\textheight}{\paperheight-\MargemSuperior-\MargemInferior}
    \setlength{\evensidemargin}{0cm}
    \setlength{\topmargin}{0cm}
    \setlength{\headsep}{25pt}
    \setlength{\headheight}{\MargemSuperior - #1 - \topmargin - \headsep}
}

%% -------------------------------------------------------------------------------
%% Definição de comandos para receber e armazenar dados para capa e folha de rosto.

\providecommand{\dadoAutor}{}
\newcommand{\Jautor}[1]{\renewcommand{\dadoAutor}{#1}}

\providecommand{\dadoOrientador}{}
\newcommand{\Jorientador}[1]{\renewcommand{\dadoOrientador}{#1}}
\providecommand{\dadoCoorientador}{}
\newcommand{\Jcoorientador}[1]{\renewcommand{\dadoCoorientador}{#1}}

\providecommand{\dadoTitulo}{}
\newcommand{\Jtitulo}[1]{\renewcommand{\dadoTitulo}{#1}}
\providecommand{\dadoCurso}{}
\newcommand{\Jcurso}[1]{\renewcommand{\dadoCurso}{#1}}
\providecommand{\dadoLocal}{}
\newcommand{\Jlocal}[1]{\renewcommand{\dadoLocal}{#1}}

\providecommand{\dadoData}{}
\newcommand{\Jdata}[1]{\renewcommand{\dadoData}{#1}}
\providecommand{\dadoCidade}{}
\newcommand{\Jcidade}[1]{\renewcommand{\dadoCidade}{#1}}

\providecommand{\dadoComent}{}
\newcommand{\Jcomentario}[1]{\renewcommand{\dadoComent}{#1}}
\providecommand{\dadoDataDep}{}
\newcommand{\Jdatadeposito}[1]{\renewcommand{\dadoDataDep}{#1}}
\providecommand{\dadoTipoOrient}{}


\newcommand{\quadrodeposito}{
\begingroup
   \begin{flushright}
      \framebox[1.05\width]{
         \begin{minipage}{7cm}
            \vspace{0.1cm}
            \scriptsize
            \begin{center}
               PROJETO DE CONCLUSÃO DE CURSO\\
            \end{center}
            \normalsize
            \begin{flushleft}
            \small
            Data de Depósito: \dadoDataDep
            \newline
            \newline
            Assinatura: \hrulefill %%line(3,0){130}
            \vspace{0.1cm}
            \end{flushleft}
         \end{minipage}
      }  %% fim do framebox
   \end{flushright}
\endgroup
}

%% Capa
\newcommand{\Jcapa}{
\begingroup
    \begin{center}
    {\dadoLocal} Campus {\dadoCidade} \\
    Curso Superior em {\dadoCurso} \\
    \end{center}
    \SalvaMargens
    \setlength{\oddsidemargin}{(\paperwidth-\textwidth-(1in+\voffset)*2)/2}

    \mbox{}

    \begin{center}
    \vfill
    \thispagestyle{empty}
    \begin{minipage}{12.5cm}
        \centering
        \hrulefill\\
        \vspace*{0.1cm}
        \textbf{
            \fontsize{15pt}{19pt}\selectfont
            {\normalfont\Large\textsf{\textbf{\dadoTitulo}}}\\
            \vspace*{0.8cm}
            \fontsize{13pt}{6pt}
            \selectfont
            \textbf{\emph{\large\dadoAutor}}
            \normalsize
        } %% fim textbf
        \\
        \hrulefill
    \end{minipage}
    \end{center}
    \vfill
    
    \begin{center}
        \includegraphics[width=.2\linewidth]{cefet.png} \\[2cm]
        {\dadoCidade} \\
        {\dadoData}
    \end{center}
    

    \clearpage{\pagestyle{empty}\cleardoublepage}

    \AlteraMargens{\MargemSuperior}{\MargemInferior}{\MargemEsquerda}{\MargemDireita}
\endgroup
}

%% Folha de rosto
\newcommand{\Jfolhaderosto}{
\begingroup
    \SalvaMargens
    \setlength{\voffset}{1.6cm-1in}
    \setlength{\oddsidemargin}{0cm}
    \setlength{\topmargin}{0cm}
    \setlength{\headsep}{0cm}
    \setlength{\headheight}{0cm}
    
    \thispagestyle{empty}
    \begin{flushleft}
    \begin{minipage}[t]{\paperwidth-3.6cm}
    %\quadrodeposito
    \vspace{2.5cm}
    \begin{minipage}[t]{\paperwidth-4cm}
    \begin{center}
        \fontsize{14pt}{18pt}
        \selectfont
        \textit{\dadoAutor}\\
        \vspace{2.5cm}
        \textbf{
            \fontsize{16pt}{21pt}
            \selectfont
            \dadoTitulo\\ 
        }        
    \end{center}
    
    \vspace{2.5cm}
    \begin{flushright}
        \begin{minipage}[t]{.6\linewidth}
            \small{\dadoComent}\\
            \vspace{0.5cm} \\
            Orientador: Prof. Dr. {\dadoOrientador} \\
            Coorientador: $Prof^a$. $Dr^a$. {\dadoCoorientador}
            \normalsize 
        \end{minipage}
    \end{flushright}
    \vspace{2cm}
    
     \begin{center}
        \includegraphics[width=.2\linewidth]{cefet.png} \\[2cm]
        {\dadoCidade} \\
        {\dadoData}
    \end{center}

    \end{minipage}
    \end{minipage}
    \end{flushleft}
    \clearpage{\pagestyle{empty}\cleardoublepage}
    \AlteraMargens[2cm]{\MargemSuperior}{\MargemInferior}{\MargemEsquerda}{\MargemDireita}

\endgroup

}

%% Folha de aprovação
\newenvironment{folhaaprovacao}[1][]{
    \SalvaMargens
    \setlength{\voffset}{1.6cm-1in}
    \setlength{\oddsidemargin}{0cm}
    \setlength{\topmargin}{0cm}
    \setlength{\headsep}{0cm}
    \setlength{\headheight}{0cm}

    \thispagestyle{empty}
    \ifthenelse{\equal{#1}{}}{}{\chapter*{#1}}
    \newcommand{\assinatura}[2]{
        \begin{center}
            \rule{11cm}{1pt}\vspace{3mm}\\##1\\##2
            \vspace{2cm}
        \end{center}
    }

}
{
    \clearpage{\pagestyle{empty}\cleardoublepage}
    \AlteraMargens[2cm]{\MargemSuperior}{\MargemInferior}{\MargemEsquerda}{\MargemDireita}
}

% ---------------------------------------------------------
% DEDICATÓRIA
\newenvironment{dedicatoria}[1][]{
     \ifthenelse{\equal{#1}{}}{}{\chapter*{#1}}
    \thispagestyle{empty}
    \mbox{}
    \vfill
    \begin{flushright}
    \onehalfspacing
    \begin{minipage}{5cm}
}
{
     \end{minipage}
    \vspace{4mm}
    \nolinebreak[1]
    \end{flushright}
    \normalsize
    \clearpage{\pagestyle{empty}\cleardoublepage}
}

% ---------------------------------------------------------
% AGRADECIMENTOS
\newenvironment{agradecimentos}[1][]{
    \ifthenelse{\equal{#1}{}}{}{\chapter*{#1}}
    \thispagestyle{empty}
    \onehalfspacing
    \setlength{\parskip}{5pt}
    \setlength{\parindent}{1.25cm}
    \normalsize
}
{
    \normalsize
    \singlespacing
    \setlength{\parskip}{0pt}
    \clearpage{\pagestyle{empty}\cleardoublepage}
}

% ---------------------------------------------------------
% EPÍGRAFE
\newenvironment{epigrafe}[3][]{
    \ifthenelse{\equal{#1}{}}{}{\chapter*{#1}}
    \thispagestyle{empty}
    \mbox{}
    \vfill
    \hfill
    \ifthenelse{\equal{#3}{}}{\begin{minipage}{12cm}}{\begin{minipage}{#3}}
    \newsavebox{\CITNAME}
    \sbox{\CITNAME}{\emph{#2}}
    \begin{quote}
}
{%
    \\\vspace{4mm}\hspace*{\fill}\nolinebreak[1]\hspace*{\fill}%
    \usebox{\CITNAME}\end{quote}
    \end{minipage}
    \normalsize
    \clearpage{\pagestyle{empty}\cleardoublepage}
}